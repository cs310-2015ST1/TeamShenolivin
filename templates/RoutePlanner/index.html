<!DOCTYPE html>
{% load staticfiles %}
<html>
    <head>
        <title>MegaByke Route Planner</title>
        <script src="http://maps.googleapis.com/maps/api/js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="{%  static "js/bikeWayPlotter.js" %}"></script>
        <script src="{%  static "js/mainScript.js" %}"></script>
        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans" />
        <link rel="stylesheet" type="text/css" href="{% static "css/htmlStyle.css" %}" />
        <input type="hidden" id="dallBikeWays" name="variable" value="{{ allBikeWays }}">
        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>
    </head>
    <body>
    <nav>
        <div id='navBar'>
            <ul>
            	<a href="/RoutePlanner/"> <li>Home </li></a> 
            	<a href="/RoutePlanner/about.html"> <li> About </li></a>                     
                {% if user.is_authenticated %}
		        <a href="/RoutePlanner/logout.html"> <li>Log Out</li></a> 
		        <a href="/RoutePlanner/account.html"> <li>My Account</li></a> 
		        {% else %}
		        <a href="/RoutePlanner/login.html"><li>Log In</li></a> 
		        <a href="/RoutePlanner/register.html"><li>Get Started</li></a> 
		        {% endif %}
            </ul>
        </div>
    </nav>
        <div id='title'>
            <h1> Route Planner </h1>
        </div>
        <div id="infoInput">
        </div>
        <div id = "extraData">
            Locations:
            <table id="markerTable"><br/>
                <tr><td><input id="locationInput1" class="controls" type="text" style="background-color:#FFFFFF" placeholder="Location 1"></td>
                    <td><img src="{{ STATIC_URL }}images/redX.png" id="delete1" alt="Delete marker" height="30" width="30" onclick="deleteClicked(event, 1);"></td></tr>
                <tr><td><input id="locationInput2" class="controls" type="text" disabled="true" style="background-color:#CCCCCC" placeholder="Location 2"></td>
                    <td><img src="{{ STATIC_URL }}images/redX.png" id="delete2" alt="Delete marker" height="30" width="30" disabled="true" onclick="deleteClicked(event, 2);"></td></tr>
                <tr><td><input id="locationInput3" class="controls" type="text" disabled="true" style="background-color:#CCCCCC" placeholder="Location 3"></td>
                    <td><img src="{{ STATIC_URL }}images/redX.png" id="delete3" alt="Delete marker" height="30" width="30" disabled="true" onclick="deleteClicked(event, 3);"></td></tr>
                <tr><td><input id="locationInput4" class="controls" type="text" disabled="true" style="background-color:#CCCCCC" placeholder="Location 4"></td>
                    <td><img src="{{ STATIC_URL }}images/redX.png" id="delete4" alt="Delete marker" height="30" width="30" disabled="true" onclick="deleteClicked(event, 4);"></td></tr>
                <tr><td><input id="locationInput5" class="controls" type="text" disabled="true" style="background-color:#CCCCCC" placeholder="Location 5"></td>
                    <td><img src="{{ STATIC_URL }}images/redX.png" id="delete5" alt="Delete marker" height="30" width="30" disabled="true" onclick="deleteClicked(event, 5);"></td></tr>
            </table>
            {% if user.is_authenticated %}
            Logged in as {{ user.username }}<br/>
            {% endif %}
            <br/>
            Last updated: {{ updateTime|safe }}
            <br/>
            {% if user.is_superuser %}
            <form action="#" method="get">
                <input class="submitBtn" type="submit" value="Update Database" name="update"> </input>
            </form>
            {% endif %}
            <button class="submitBtn" type="reset" onclick="resetClicked(event);">Reset Markers</button>
            <br> Please enter the start location.
            <br><input type="number" MIN="1" MAX="5" STEP="1" VALUE="1" SIZE="6" id="spinner1" class="controls"> </input>
            <br> Please enter the end location.
            <br><input type="number" MIN="1" MAX="5" STEP="1" VALUE="5" SIZE="6" id="spinner2" class="controls"> </input>
            <br><button class="submitBtn" type="button" onclick="plotCalcRoute();">Plot Routes</button>
        </div>
        <div id="googleMap">
        </div>

    <div id="fb-root"></div>
    <script type="text/javascript">
        window.fbAsyncInit = function() {
            FB.init({
                appId: '800885373358594',
                status: true, 
                cookie: true,
                xfbml: true
            });
        };
        function() {
            var e = document.createElement('script'); 
            e.async = true;
            e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
            document.getElementById('fb-root').appendChild(e);
        }();

        function saveMapToDataUrl() {

            var element = $("#mapDiv");

            html2canvas(element, {
                useCORS: true,
                onrendered: function(canvas) {
                    var dataUrl= canvas.toDataURL("image/png");
                    console.log(dataUrl);
                    // TODO: DO SOMETHING WITH THE DATAURL
                    // Eg. write it to the page

                    $(document).ready(function(){
                        $('#share_button').click(function(e){
                            e.preventDefault();
                            FB.ui(
                                {
                                    method: 'feed',
                                    name: 'This is the content of the "name" field.',
                                    link: 'http://127.0.0.1:8000/RoutePlanner/',
                                    picture: 'dataUrl',
                                    caption: 'This is the content of the "caption" field.',
                                    description: 'This is the content of the "description" field, below the caption.',
                                    message: ''
                                });
                            });
                    });
                    document.write('<img src="' + dataUrl + '"/>');
                }
            });
        }

    </script>

    <div
      class="fb-like"
      data-share="true"
      data-width="450"
      data-show-faces="true">
    </div>

    </body>
    
</html>
